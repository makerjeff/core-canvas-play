<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rembound 01</title>

    <script>
        //game.js
        window.onload = function(e) {

            // get canvas and context
            var canvas = document.getElementById('viewport');
            var context = canvas.getContext('2d');

            canvas.imageSmoothingEnabled =false;

            // timing and fps
            var last_frame = 0;
            var fps_time = 0;
            var frame_count = 0;
            var fps = 0;

            // initialize game
            function init() {
                //add mouse events
                canvas.addEventListener('mousemove', onMouseMove);
                canvas.addEventListener('mousedown', onMouseDown);
                canvas.addEventListener('mouseup', onMouseUp);
                canvas.addEventListener('mouseout', onMouseOut);

                // enter main loop
                main(0);
            }

            // main loop
            function main(t_frame) {
                // request animation frame
                window.requestAnimationFrame(main);

                update(t_frame);
                render();
            }

            //Update the game state
            function update(t_frame) {
                var dt = (t_frame - last_frame) / 1000;
                last_frame = t_frame;

                // update fps counter
                update_fps(dt);
            }

            // Update FPS
            function update_fps(dt) {

                if (fps_time > 0.25) {

                    //calculate FPS
                    fps = Math.round(frame_count / fps_time);

                    // reset time and framecount
                    fps_time = 0;
                    frame_count = 0;
                }

                // Increase time and frame count
                fps_time += dt;
                frame_count++;
            }

            // RENDER
            function render() {
                // draw the frame
                drawFrame();
            }

            // Draw a frame with a border
            function drawFrame() {
                // Draw background and a border
                context.fillStyle = '#d0d0d0';
                context.fillRect(0, 0, canvas.width, canvas.height);
                context.fillStyle = '#e8eaec';
                context.fillRect(1, 1, canvas.width-2, canvas.height-2);

                // draw header
                context.fillStyle = '#303030';
                context.fillRect(0, 0, canvas.width, 65);

                // draw title
                context.fillStyle = '#ffffff';
                context.font = '24px Verdana';
                context.fillText('HTML5 Canvas Basic Framework - Rembound.com', 10, 30);

                // display FPS
                context.fillStyle = '#ffffff';
                context.font = '12px Verdana';
                context.fillText('FPS: ' + fps, 13, 50);
            }

            // MOUSE event handlers
            function onMouseMove(e) {}
            function onMouseDown(e) {}
            function onMouseUp(e) {}
            function onMouseOut(e) {}

            // Get mouse position
            function getMousePos(canvas, e) {
                var rect = canvas.getBoundingClientRect();

                return {
                    x: Math.round((e.clientX - rect.left) / (rect.right - rect.left) + canvas.width),
                    y: Math.round((e.clientY - rect.top) / (rect.bottom - rect.top) * canvas.height)
                }
            }

            // call init to start the game
            init();
        }
    </script>
</head>
<body>

<canvas id="viewport" width="640" height="480"></canvas>

<script>
    // http://rembound.com/articles/how-to-make-a-html5-canvas-game
    // HTML5 Canvas Basic Game Framework

</script>
</body>
</html>